points <- st_centroid(world)
View(points)
points <- st_centroid(world)%>%
select(name) %>%
right_join(plants_by_country, by = c("name" = "country")) %>%
st_transform(crs)
ggplot() +
theme_minimal(base_size = 9) +
geom_sf(data = world, color = "white", fill = "#E1E1E1") +
geom_sf(data = points, aes(size = frequency,
color = frequency),
alpha = .75) +
scale_size(range = c(1, 13), breaks = seq(0, 60, by = 15)) +
scale_color_viridis_c(guide = FALSE) +
scale_x_continuous(breaks = c(1e10, 2e10)) +
# geom_hline(yintercept = 0) +
# geom_vline(xintercept = 0) +
coord_sf(crs = crs) +
labs(size = element_blank(),
title = "Number of species extinct by Agriculture & Aquaculture",
caption = "Source:  International Union for Conservation of Nature (IUCN)\nRed list of Threatened Species (Version 2020-1)") +
theme(legend.position = "bottom",
plot.title = element_text(size = 9 * 1.2,
face = "bold",
color = "#222222",
hjust = 0.5,
margin = margin(9, 0, 9, 0))) +
guides(size = guide_legend(nrow = 1, override.aes = list(color = viridis::viridis(4))))
library(tidyverse)
library(extrafont)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(viridis)
library(here)
plants <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-18/plants.csv')
plants.weighting <- plants %>%
count(country, sort = T) %>%
rename(count = n) %>%
rename(name = country) %>%
mutate(
name = case_when(
name == "Pitcairn" ~ "Pitcairn Is.",
name == "Cook Islands" ~ "Cook Is.",
name == "Cabo Verde" ~ "Cape Verde",
name == "Viet Nam" ~ "Vietnam",
name == "United States" ~ "United States of America",
name == "Sao Tome and Principe" ~ "São Tomé and Principe",
name == "Saint Helena, Ascension and Tristan da Cunha" ~ "Saint Helena",
name == "French Polynesia" ~ "Fr. Polynesia",
TRUE ~ name)
)
world <- ne_countries(scale = "large", returnclass = "sf")
world <- left_join(world, plants.weighting, by = "name")
ggplot(world) +
geom_sf(color = NA, aes(fill = count)) +
coord_sf(ylim = c(-50,80)) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(ylim = c(-50,80)) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
crs <- "+proj=moll +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs"
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
scale_x_continuous(breaks = c(1e10, 2e10)) +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
scale_x_continuous(breaks = c(1e10, 2e10)) +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
scale_size(range = c(1, 13), breaks = seq(0, 60, by = 15)) +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
library(geomorph)
library(tidyverse)
library(Momocs)
library(extrafont)
shape.table <- read.csv("singh_et_al_2020.csv", header = T, row.names = 1)
shape.table$sex <- as.factor(shape.table$sex)
shape.table <- as.tibble(shape.table)
shape.data <- import_tps("singh_et_al_2020.tps")
shape.ldk  <- Ldk(shape.data$coo, fac = shape.table)
shape.ldk$coo[which(shape.ldk$perspective=="b")] <- lapply(shape.ldk$coo[which(shape.ldk$perspective=="b")], coo_flipy)
panel(shape.ldk)
shape.ldk  <- Ldk(shape.data$coo, fac = shape.table)
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-sex-determination")
shape.table <- read.csv("singh_et_al_2020.csv", header = T, row.names = 1)
shape.table$sex <- as.factor(shape.table$sex)
shape.table <- as.tibble(shape.table)
shape.data <- import_tps("singh_et_al_2020.tps")
shape.ldk  <- Ldk(shape.data$coo, fac = shape.table)
shape.ldk$coo[which(shape.ldk$perspective=="b")] <- lapply(shape.ldk$coo[which(shape.ldk$perspective=="b")], coo_flipy)
panel(shape.ldk)
?writeland.tps
shape.ldk$coo
as.array(shape.ldk$coo)
test <- as.array(shape.ldk$coo)
writeland.tps(test, "test.tps")
gpagen(shape.ldk$coo)
arrayspecs((shape.ldk$coo, 53, 2)
arrayspecs(shape.ldk$coo, 53, 2)
test <- arrayspecs(shape.ldk$coo, 53, 2)
test <- arrayspecs(shape.ldk, 53, 2)
test <- arrayspecs(shape.ldk$coo, 53, 2)
as_df(shape.ldk$coo)
as_df(shape.ldk)
test <- as_df(shape.ldk)
View(test)
test <- arrayspecs(test$coo, 53, 2)
shape.ldk$coo
test <- shape.ldk$coo
as_df(test)
test <- arrayspecs(test, 53, 2)
as.matrix(test)
as.matrix(shape.ldk$coo)
as.matrix(test)
test <- as.matrix(test)
View(test)
test <- shape.ldk$coo
test <- shape.ldk$coo
test <- arrayspecs(test, 53, 2)
as_df(shape.ldk)
as_df(shape.ldk$coo)
as.array(shape.ldk$coo)
test <- as.array(shape.ldk$coo)
test <- arrayspecs(test, 53, 2)
as_data_frame(test)
as.matrix(test)
test <- as.matrix(test)
View(test)
test <- arrayspecs(test, 53, 2)
writeland.tps(test, "test.tps")
test <- as.array(shape.ldk$coo)
test <- as.matrix(test)
View(test)
test <- arrayspecs(test, 53, 2)
test <- arrayspecs(test)
test <- as.array(shape.ldk$coo)
test <- as.matrix(test)
test <- arrayspecs(test)
test <- arrayspecs(test, p = 53)
test <- arrayspecs(test, p = 53, k = 2)
shape.ldk$coo
shape.gdf <- geomorph.data.frame(shape.ldk$coo, sex = shape.table$sex)
anova(procD.lm(shape.fg, shape.table$sex))
anova(procD.lm(shape.ldk, shape.table$sex))
anova(procD.lm(coords ~ sex, data  = shape.gdf))
shape.gdf <- geomorph.data.frame(shape.ldk, sex = shape.table$sex)
shape.gdf <- geomorph.data.frame(shape.ldk$coo, sex = shape.table$sex)
anova(procD.lm(coords ~ sex, data  = shape.gdf))
anova(procD.lm(shape.gdf[1:299] ~ sex, data  = shape.gdf))
anova(procD.lm(shape.gdf[,1:299] ~ sex, data  = shape.gdf))
anova(procD.lm(shape.gdf[1:299,] ~ sex, data  = shape.gdf))
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "Open Sans"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
library(geomorph)
library(tidyverse)
library(Momocs)
library(extrafont)
shape.table <- read.csv("singh_et_al_2020.csv", header = T, row.names = 1)
shape.table$sex <- as.factor(shape.table$sex)
shape.table <- as.tibble(shape.table)
shape.data <- import_tps("singh_et_al_2020.tps")
shape.ldk  <- Ldk(shape.data$coo, fac = shape.table)
shape.ldk$coo[which(shape.ldk$perspective=="b")] <- lapply(shape.ldk$coo[which(shape.ldk$perspective=="b")], coo_flipy)
panel(shape.ldk)
shape.fg <- fgProcrustes(shape.ldk)
stack(shape.fg)
shape.pca <- PCA(shape.fg)
shape.pca.data <- as.tibble(shape.pca$x)
shape.data.new <- cbind(shape.table, shape.pca.data)
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "Open Sans"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
PCcontrib(shape.pca)
PCcontrib(shape.pca, nax = 1:5)
PCcontrib(shape.pca, nax = 1:5)
PCcontrib(shape.pca, nax = 1:3)
shape.ldk  <- Ldk(shape.data$coo, fac = shape.table, links = NULL)
shape.ldk$coo[which(shape.ldk$perspective=="b")] <- lapply(shape.ldk$coo[which(shape.ldk$perspective=="b")], coo_flipy)
panel(shape.ldk)
shape.fg <- fgProcrustes(shape.ldk)
stack(shape.fg)
shape.pca <- PCA(shape.fg)
PCcontrib(shape.pca, nax = 1:3)
PCcontrib(shape.pca, nax = 1:3, poly = FALSE)
PCcontrib(shape.pca, nax = 1:3, lwd = 0)
PCcontrib(shape.pca, nax = 1:3, lty = 0)
PCcontrib(shape.pca, nax = 1:3, points = TRUE)
PCcontrib(shape.pca, nax = 1:3, points = TRUE, cex = 20)
