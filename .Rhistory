name == "Cook Islands" ~ "Cook Is.",
name == "Cabo Verde" ~ "Cape Verde",
name == "Viet Nam" ~ "Vietnam",
name == "United States" ~ "United States of America",
name == "Sao Tome and Principe" ~ "São Tomé and Principe",
name == "Saint Helena, Ascension and Tristan da Cunha" ~ "Saint Helena",
name == "French Polynesia" ~ "Fr. Polynesia",
TRUE ~ name)
)
world <- ne_countries(scale = "large", returnclass = "sf")
world <- left_join(world, plants.weighting, by = "name")
ggplot(world) +
geom_sf(color = NA, aes(fill = count)) +
coord_sf(ylim = c(-50,80)) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(ylim = c(-50,80)) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
crs <- "+proj=moll +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs"
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
scale_x_continuous(breaks = c(1e10, 2e10)) +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
scale_x_continuous(breaks = c(1e10, 2e10)) +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
ggplot(world) +
geom_sf(color = "white", aes(fill = count)) +
coord_sf(crs = crs) +
scale_fill_viridis(option = "plasma", na.value = "grey80") +
theme_void() +
scale_size(range = c(1, 13), breaks = seq(0, 60, by = 15)) +
labs(title = "#TidyTuesday Week 34: Plants in Danger",
subtitle = "Global Extinct Plant Species (1900-2020)",
fill = "Species Count",
caption = "Source: International Union for Conservation of Nature (IUCN) \n Data prepared by Florent Lavergne and R for Data Science (R4DS)") +
theme(
panel.background = element_rect(fill = "grey97", linetype = 0),
plot.background = element_rect(fill = "grey97", linetype = 0),
text = element_text(family = "Open Sans"),
legend.position = c(0.15, 0.1),
legend.direction = "horizontal",
legend.title = element_text(
vjust = .8,
size = 8),
legend.text = element_text(
size = 8),
plot.title = element_text(
hjust = 0,
size = 22,
margin = margin(5, 2, 5, 2),
face = "bold"),
plot.subtitle = element_text(
hjust = 0,
size = 10,
margin = margin(2, 2, 2, 2)),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
plot.margin = unit(c(1, 1, 1, 1), "cm"),
plot.caption = element_text(
size = 8,
family = "Open Sans",
color = "grey50")
) +
annotate(
geom = "text",
x = 75,
y = -25,
label = "Madagascar is home\n to almost 20% of all\n extinct species!",
family = "Open Sans",
size = 3.5)
library(tidytuesdayR
)
tidytuesdayR::tt_load(week = 35)
Sys.info()
library(geomorph)
library(tidyverse)
library(Momocs)
library(extrafont)
library(tidytext)
shape.table <- read.csv("singh_et_al_2020.csv", header = T, row.names = 1)
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/-sex-determination")
shape.table <- read.csv("singh_et_al_2020.csv", header = T, row.names = 1)
shape.table$sex <- as.factor(shape.table$sex)
shape.table <- as_tibble(shape.table)
shape.data <- import_tps("singh_et_al_2020.tps")
shape.ldk  <- Ldk(shape.data$coo, fac = shape.table, links = NULL)
shape.gpa <- fgProcrustes(shape.ldk)
stack(shape.gpa,
title = "",
centroid = FALSE,
xy.axis = FALSE,
ldk_cex = 0.75,
meanshape = TRUE)
shape.pca <- PCA(shape.gpa)
shape.pca.data <- as_tibble(shape.pca$x)
shape.data.new <- cbind(shape.table, shape.pca.data)
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "Open Sans"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "fira"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
fonts()
library(showtext)
library(showtext)
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "fira"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
font.add.google("Fira Sans", "fira")
showtext.auto()
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "fira"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
ggsave("figure_1.tiff", plot = last_plot(), dpi = 300, device = cairo_pdf)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 300, device = cairo_pdf)
stack(shape.gpa,
title = "",
centroid = FALSE,
xy.axis = FALSE,
ldk_cex = 0.75,
meanshape = TRUE)
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "fira"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 300, device = cairo_pdf)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 400, device = cairo_pdf)
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "fira"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 400, device = cairo_pdf)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 400)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 400, device = cairo_pdf())
ggplot(shape.data.new, aes(PC1, PC2, colour = sex)) +
geom_point(alpha = 0.9) +
lims(x = c(-0.1,0.1), y = c(-0.1,0.1)) +
labs(x = "Principal Component 1 (43.0%)",
y = "Principal Component 2 (18.2%)",
colour = "Sex") +
scale_colour_manual(values=c("orange2","royalblue4"), labels = c("Female", "Male")) +
stat_ellipse(level = 0.66) +
theme_minimal() +
coord_fixed() +
theme(
text = element_text(family = "Open Sans"),
legend.position = "bottom",
legend.text = element_text(size = 11),
axis.title.x = element_text(margin = margin(t = 15, r = 0, b = 0, l = 0)),
axis.title.y = element_text(margin = margin(t = 0, r = 15, b = 0, l = 0)),
plot.margin = unit(c(5, 5, 5, 5), "mm")
)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 300, device = cairo_pdf)
ggsave("figure_2.tiff", plot = last_plot(), dpi = 300)
shape.pca.2 <- gm.prcomp(shape.gpa2$coords)
shape.data.2 <- readland.tps("singh_et_al_2020.tps")
shape.gpa2 <- gpagen(shape.data.2)
shape.data.2 <- readland.tps("Johnson_et_al_2020.tps")
shape.pca.2 <- gm.prcomp(shape.gpa2$coords)
shape.data.2 <- readland.tps("Johnson_et_al_2020.tps")
shape.gpa2 <- gpagen(shape.data.2)
shape.gdf <- geomorph.data.frame(shape.gpa2, sex = shape.table$sex)
shape.pca.2 <- gm.prcomp(shape.gpa2$coords)
plotRefToTarget(shape.pca.2$shapes$shapes.comp1$min,
shape.pca.2$shapes$shapes.comp1$max,
method = "vector",
label = FALSE,
gridPars = gridPar(pt.size = 1.25))
plotRefToTarget(shape.pca.2$shapes$shapes.comp1$min,
shape.pca.2$shapes$shapes.comp1$max,
method = "vector",
label = FALSE,
gridPars = gridPar(pt.size = 1.25))
